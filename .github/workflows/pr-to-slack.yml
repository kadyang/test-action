name: PR to Slack

on:
  pull_request_target:
    types: [ labeled ]

jobs:
  slackNotification:
    if: ${{ github.event.label.name == 'üëÄ  Needs Review' }}
    name: Slack Notification
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Slack Notification
        uses: rtCamp/action-slack-notify@v2
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
          SLACK_USERNAME: ÈªûÂ∞çÈªû Github Action
          SLACK_CUSTOM_PAYLOAD: '{
	"username" : "ÈªûÂ∞çÈªû Github Action Ê©üÂô®‰∫∫",
    "icon_emoji" : ":chino-star:",
	"blocks": [
		{
			"type": "header",
			"text": {
				"type": "plain_text",
				"text": "ÊúâÊñ∞ÁöÑ PR Ë´ãÂπ´Áúã :pray:",
				"emoji": true
			}
		},
		{
			"type": "section",
			"fields": [
				{
					"type": "mrkdwn",
					"text": "*Creator*\n${{ github.event.pull_request.user.login }}"
				}
			]
		},
		{
			"type": "section",
			"fields": [
				{
					"type": "mrkdwn",
					"text": "*Label*\n${{ github.event.label.name }}"
				}
			]
		},
		{
			"type": "section",
			"fields": [
				{
					"type": "mrkdwn",
					"text": "*Link*\n<${{ github.event.pull_request.html_url }}>"
				}
			]
		},
		{
			"type": "section",
			"fields": [
				{
					"type": "mrkdwn",
					"text": "*Title*\n${{ github.event.pull_request.title }}"
				}
			]
		},
		{
			"type": "section",
			"fields": [
				{
					"type": "mrkdwn",
					"text": "*Message*\n${{ github.event.pull_request.body }}"
				}
			]
		}
	]
}'
